# IKH Systems — Технический отчет (актуальная версия)

Короткое техническое описание текущей реализации лендинга с акцентом на архитектуру, SEO-консистентность и производительность. Инструкции и гайдов нет умышленно.

## Архитектура и сборка
- **Next.js 15 (App Router), React 19, TypeScript**
- **Вывод**: `output: 'export'` (статический экспорт), HTML отдается Nginx
- **ISR**: `revalidate = 86400` для страниц локалей
- **Изображения**: AVIF/WebP, `images.unoptimized = true` (совместимо со статическим экспортом)

## Маршруты и i18n
- Локали: `cs`, `en`, `de`, `ua` с отдельными путями `/<lang>`
- Корень `/` делает 302 на `/en`
- Навигация и футер формируют локальные ссылки через `localeHref`

## SEO и каноникализация
- Canonical и hreflang формируются через `generateMetadata` для каждой локали:
  - canonical указывает на точный URL без завершающего слэша и без `.html`
  - `alternates.languages` содержит взаимные ссылки всех локалей
- Sitemap (`app/sitemap.ts`):
  - публикует только конечные URL (без редиректов)
  - содержит `alternates.languages` для всех локалей
- Robots (`app/robots.ts`):
  - разрешен корень
  - запрещены `/_next/`, `/api/`, служебные пути, а также `/*.html$` и `/*.txt$` для исключения дублей
- Серверная каноникализация (Nginx):
  - `/.+\/$ → /.+` (убираем завершающий слэш)
  - `/path.html → /path` (убираем расширение)
  - принудительный `https` и canonical-домен (`www → non-www`)

## Производительность и стабильность
- СSG + строгие кэши для статики (`_next/static`, `/media`, шрифты)
- Предзагрузка логотипа, минимальный critical CSS в корневом `layout`
- Отключены лишние логи, включена сжатая раздача, `modularizeImports`

## Безопасность
- HTTP headers: `X-Frame-Options`, `X-Content-Type-Options`, `Referrer-Policy`, `X-XSS-Protection`, `HSTS`
- CSP для SVG-изображений в Next и базовая CSP в Nginx

## Данные и аналитика
- Поддержка GA/GTM через переменные окружения; включение только в `production`
- Cookie Consent и PageViewTracker подключены на уровне layout

## Переменные окружения
- `NEXT_PUBLIC_SITE_URL` — базовый публичный URL, без завершающего слэша
- (опционально) `NEXT_PUBLIC_BASE_URL_[CS|EN|DE|UA]` — для доменных локалей; если не заданы, используются fallback вида `${SITE_URL}/<lang>`

## Точки внимания (закрытые)
- Дубли `.html` и трейлинг-слэши — устранены редиректами и не попадают в sitemap
- Несовпадение canonical/hreflang — устранено единообразной генерацией мета и альтернатив
- 404 по «about» — маршрут отсутствует и не публикуется в sitemap; пустой каталог не линкуется

## Тесты и контроль качества
- Playwright: дымовые тесты проверяют наличие canonical и язык страницы
- Lighthouse использовался локально; отчет в репозитории не хранится

## Лицензия и контакт
- Автор: IKH Systems
- Контакты: contact@ikhsystems.com, +420 728 209 012